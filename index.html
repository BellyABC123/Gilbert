<!DOCTYPE html>
<html lang="en">
<title>STEPH LOVES TYLER</title>
<link href="style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<script>
    var sample;
    var getViewObject;
    var editor;
    var output;
    var parseCurrent;
    var stopDemHaterz;
    var saveData;
</script>
<div id="editor">
</div>

<div id="editor"></div>
    
<div id="output">
    <a href="#" id="toggle-output">Toggle</a>

    Dis is where the output is.
    <div id="htmlout">
        <a href="#" id="get-lines">Get</a>
        HTML output
    </div>

    <div id="iosout">
        iOS output
    </div>
</div>

<script src="ace.js" type="text/javascript" charset="utf-8"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="haterz.js"></script>
<script>

    editor = new ace.edit("editor");
    editor.setTheme("ace/theme/monokai");
    editor.getSession().setMode("ace/mode/json");
    editor.setShowPrintMargin(false);
    editor.getSession().setUseSoftTabs(true);

    output = new ace.edit("output");
    output.setTheme("ace/theme/monokai");
    output.getSession().setMode("ace/mode/objectivec");
    output.setShowPrintMargin(false);
    output.getSession().setUseSoftTabs(true);
    $(window).resize(stopDemHaterz);

    saveData = function() {
        var currentcode = editor.getValue();
        console.log(currentcode);
        $.ajax({
            type: "post",
            data: {code: currentcode},
            url: "/savedCode",
            success: true
        });
    }

    function getData() {
        $.ajax({
            type: "get",
            url: "/savedCode",
            success: function(data) {
                console.log(JSON.stringify(data.code));
                editor.setValue(JSON.stringify(data.code, undefined, 4));
            }
        });
    }

    editor.getSession().on('change', function(e){
        parseCurrent();
    });

    $(document).ready(function(){
        getData();
        stopDemHaterz();
        parseCurrent();
    });

    $("#get-lines").click(function(){
        console.log(editor.getValue());
        });

    editor.addEventListener('keydown', function(e) {
        if (e.keyCode === 13) {
            parseCurrent();
        }
    }, false);
</script>
<script src="parser.js"></script>
<!-- <script src="htmlparser.js"></script> -->
</body>
</html>
